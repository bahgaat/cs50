{"changed":true,"filter":false,"title":"copy.c","tooltip":"~/workspace/whodunit/copy.c","value":"// Copies a BMP file\n\n#include <stdio.h>\n#include <stdlib.h>\n\n#include \"bmp.h\"\n\nint main(int argc, char *argv[])\n{\n    // ensure proper usage\n    if (argc != 3)\n    {\n        fprintf(stderr, \"Usage: copy infile outfile\\n\");\n        return 1;\n    }\n\n    // remember filenames\n    char *infile = argv[1];\n    char *outfile = argv[2];\n\n    // open input file\n    FILE *inptr = fopen(infile, \"r\");\n    if (inptr == NULL)\n    {\n        fprintf(stderr, \"Could not open %s.\\n\", infile);\n        return 2;\n    }\n\n    // open output file\n    FILE *outptr = fopen(outfile, \"w\");\n    if (outptr == NULL)\n    {\n        fclose(inptr);\n        fprintf(stderr, \"Could not create %s.\\n\", outfile);\n        return 3;\n    }\n\n    // read infile's BITMAPFILEHEADER\n    BITMAPFILEHEADER bf;\n    fread(&bf, sizeof(BITMAPFILEHEADER), 1, inptr);\n\n    // read infile's BITMAPINFOHEADER\n    BITMAPINFOHEADER bi;\n    fread(&bi, sizeof(BITMAPINFOHEADER), 1, inptr);\n\n    // ensure infile is (likely) a 24-bit uncompressed BMP 4.0\n    if (bf.bfType != 0x4d42 || bf.bfOffBits != 54 || bi.biSize != 40 ||\n        bi.biBitCount != 24 || bi.biCompression != 0)\n    {\n        fclose(outptr);\n        fclose(inptr);\n        fprintf(stderr, \"Unsupported file format.\\n\");\n        return 4;\n    }\n\n    // write outfile's BITMAPFILEHEADER\n    fwrite(&bf, sizeof(BITMAPFILEHEADER), 1, outptr);\n\n    // write outfile's BITMAPINFOHEADER\n    fwrite(&bi, sizeof(BITMAPINFOHEADER), 1, outptr);\n\n    // determine padding for scanlines\n    int padding = (4 - (bi.biWidth * sizeof(RGBTRIPLE)) % 4) % 4;\n\n    // iterate over infile's scanlines\n    for (int i = 0, biHeight = abs(bi.biHeight); i < biHeight; i++)\n    {\n        // iterate over pixels in scanline\n        for (int j = 0; j < bi.biWidth; j++)\n        {\n            // temporary storage\n            RGBTRIPLE triple;\n\n\n            // read RGB triple from infile\n            fread(&triple, sizeof(RGBTRIPLE), 1, inptr);\n\n            // write RGB triple to outfile\n            fwrite(&triple, sizeof(RGBTRIPLE), 1, outptr);\n        }\n\n        // skip over padding, if any\n        fseek(inptr, padding, SEEK_CUR);\n\n        // then add it back (to demonstrate how)\n        for (int k = 0; k < padding; k++)\n        {\n            fputc(0x00, outptr);\n        }\n    }\n\n    // close infile\n    fclose(inptr);\n\n    // close outfile\n    fclose(outptr);\n\n    // success\n    return 0;\n}\n","undoManager":{"mark":-2,"position":36,"stack":[[{"start":{"row":71,"column":29},"end":{"row":72,"column":0},"action":"insert","lines":["",""],"id":2},{"start":{"row":72,"column":0},"end":{"row":72,"column":12},"action":"insert","lines":["            "]},{"start":{"row":72,"column":12},"end":{"row":72,"column":13},"action":"insert","lines":["t"]},{"start":{"row":72,"column":13},"end":{"row":72,"column":14},"action":"insert","lines":["r"]},{"start":{"row":72,"column":14},"end":{"row":72,"column":15},"action":"insert","lines":["i"]}],[{"start":{"row":72,"column":15},"end":{"row":72,"column":16},"action":"insert","lines":["p"],"id":3},{"start":{"row":72,"column":16},"end":{"row":72,"column":17},"action":"insert","lines":["l"]},{"start":{"row":72,"column":17},"end":{"row":72,"column":18},"action":"insert","lines":["e"]}],[{"start":{"row":72,"column":18},"end":{"row":72,"column":19},"action":"insert","lines":["."],"id":4},{"start":{"row":72,"column":19},"end":{"row":72,"column":20},"action":"insert","lines":["r"]}],[{"start":{"row":72,"column":20},"end":{"row":72,"column":21},"action":"insert","lines":["g"],"id":5},{"start":{"row":72,"column":21},"end":{"row":72,"column":22},"action":"insert","lines":["b"]},{"start":{"row":72,"column":22},"end":{"row":72,"column":23},"action":"insert","lines":["t"]}],[{"start":{"row":72,"column":23},"end":{"row":72,"column":24},"action":"insert","lines":["B"],"id":6},{"start":{"row":72,"column":24},"end":{"row":72,"column":25},"action":"insert","lines":["l"]},{"start":{"row":72,"column":25},"end":{"row":72,"column":26},"action":"insert","lines":["u"]},{"start":{"row":72,"column":26},"end":{"row":72,"column":27},"action":"insert","lines":["e"]}],[{"start":{"row":72,"column":27},"end":{"row":72,"column":28},"action":"insert","lines":[" "],"id":7},{"start":{"row":72,"column":28},"end":{"row":72,"column":29},"action":"insert","lines":["="]}],[{"start":{"row":72,"column":29},"end":{"row":72,"column":30},"action":"insert","lines":[" "],"id":8},{"start":{"row":72,"column":30},"end":{"row":72,"column":31},"action":"insert","lines":["0"]}],[{"start":{"row":72,"column":31},"end":{"row":72,"column":32},"action":"insert","lines":["+"],"id":9},{"start":{"row":72,"column":32},"end":{"row":72,"column":33},"action":"insert","lines":["_"]}],[{"start":{"row":72,"column":32},"end":{"row":72,"column":33},"action":"remove","lines":["_"],"id":10},{"start":{"row":72,"column":31},"end":{"row":72,"column":32},"action":"remove","lines":["+"]}],[{"start":{"row":72,"column":31},"end":{"row":72,"column":32},"action":"insert","lines":["*"],"id":11},{"start":{"row":72,"column":32},"end":{"row":72,"column":33},"action":"insert","lines":["0"]},{"start":{"row":72,"column":33},"end":{"row":72,"column":34},"action":"insert","lines":["0"]}],[{"start":{"row":72,"column":34},"end":{"row":72,"column":35},"action":"insert","lines":[";"],"id":12}],[{"start":{"row":72,"column":35},"end":{"row":73,"column":0},"action":"insert","lines":["",""],"id":13},{"start":{"row":73,"column":0},"end":{"row":73,"column":12},"action":"insert","lines":["            "]},{"start":{"row":73,"column":12},"end":{"row":73,"column":13},"action":"insert","lines":["t"]},{"start":{"row":73,"column":13},"end":{"row":73,"column":14},"action":"insert","lines":["r"]},{"start":{"row":73,"column":14},"end":{"row":73,"column":15},"action":"insert","lines":["i"]}],[{"start":{"row":73,"column":15},"end":{"row":73,"column":16},"action":"insert","lines":["p"],"id":14},{"start":{"row":73,"column":16},"end":{"row":73,"column":17},"action":"insert","lines":["l"]},{"start":{"row":73,"column":17},"end":{"row":73,"column":18},"action":"insert","lines":["e"]},{"start":{"row":73,"column":18},"end":{"row":73,"column":19},"action":"insert","lines":["."]}],[{"start":{"row":73,"column":19},"end":{"row":73,"column":20},"action":"insert","lines":["r"],"id":15},{"start":{"row":73,"column":20},"end":{"row":73,"column":21},"action":"insert","lines":["g"]},{"start":{"row":73,"column":21},"end":{"row":73,"column":22},"action":"insert","lines":["b"]},{"start":{"row":73,"column":22},"end":{"row":73,"column":23},"action":"insert","lines":["t"]}],[{"start":{"row":73,"column":23},"end":{"row":73,"column":24},"action":"insert","lines":["G"],"id":16},{"start":{"row":73,"column":24},"end":{"row":73,"column":25},"action":"insert","lines":["r"]},{"start":{"row":73,"column":25},"end":{"row":73,"column":26},"action":"insert","lines":["e"]},{"start":{"row":73,"column":26},"end":{"row":73,"column":27},"action":"insert","lines":["e"]}],[{"start":{"row":73,"column":27},"end":{"row":73,"column":28},"action":"insert","lines":["n"],"id":17}],[{"start":{"row":73,"column":28},"end":{"row":73,"column":29},"action":"insert","lines":[" "],"id":18},{"start":{"row":73,"column":29},"end":{"row":73,"column":30},"action":"insert","lines":["="]}],[{"start":{"row":73,"column":30},"end":{"row":73,"column":31},"action":"insert","lines":[" "],"id":19},{"start":{"row":73,"column":31},"end":{"row":73,"column":32},"action":"insert","lines":["0"]}],[{"start":{"row":73,"column":32},"end":{"row":73,"column":33},"action":"insert","lines":["*"],"id":20},{"start":{"row":73,"column":33},"end":{"row":73,"column":34},"action":"insert","lines":["f"]},{"start":{"row":73,"column":34},"end":{"row":73,"column":35},"action":"insert","lines":["f"]}],[{"start":{"row":73,"column":35},"end":{"row":73,"column":36},"action":"insert","lines":[";"],"id":21}],[{"start":{"row":73,"column":36},"end":{"row":74,"column":0},"action":"insert","lines":["",""],"id":22},{"start":{"row":74,"column":0},"end":{"row":74,"column":12},"action":"insert","lines":["            "]},{"start":{"row":74,"column":12},"end":{"row":74,"column":13},"action":"insert","lines":["t"]},{"start":{"row":74,"column":13},"end":{"row":74,"column":14},"action":"insert","lines":["r"]},{"start":{"row":74,"column":14},"end":{"row":74,"column":15},"action":"insert","lines":["i"]},{"start":{"row":74,"column":15},"end":{"row":74,"column":16},"action":"insert","lines":["p"]}],[{"start":{"row":74,"column":16},"end":{"row":74,"column":17},"action":"insert","lines":["l"],"id":23},{"start":{"row":74,"column":17},"end":{"row":74,"column":18},"action":"insert","lines":["e"]},{"start":{"row":74,"column":18},"end":{"row":74,"column":19},"action":"insert","lines":["."]}],[{"start":{"row":74,"column":19},"end":{"row":74,"column":20},"action":"insert","lines":["r"],"id":24},{"start":{"row":74,"column":20},"end":{"row":74,"column":21},"action":"insert","lines":["g"]},{"start":{"row":74,"column":21},"end":{"row":74,"column":22},"action":"insert","lines":["b"]},{"start":{"row":74,"column":22},"end":{"row":74,"column":23},"action":"insert","lines":["t"]}],[{"start":{"row":74,"column":23},"end":{"row":74,"column":24},"action":"insert","lines":["R"],"id":25},{"start":{"row":74,"column":24},"end":{"row":74,"column":25},"action":"insert","lines":["e"]},{"start":{"row":74,"column":25},"end":{"row":74,"column":26},"action":"insert","lines":["d"]}],[{"start":{"row":74,"column":26},"end":{"row":74,"column":27},"action":"insert","lines":[" "],"id":26},{"start":{"row":74,"column":27},"end":{"row":74,"column":28},"action":"insert","lines":["="]}],[{"start":{"row":74,"column":28},"end":{"row":74,"column":29},"action":"insert","lines":[" "],"id":27},{"start":{"row":74,"column":29},"end":{"row":74,"column":30},"action":"insert","lines":["0"]}],[{"start":{"row":74,"column":30},"end":{"row":74,"column":31},"action":"insert","lines":["*"],"id":28},{"start":{"row":74,"column":31},"end":{"row":74,"column":32},"action":"insert","lines":["o"]},{"start":{"row":74,"column":32},"end":{"row":74,"column":33},"action":"insert","lines":["o"]}],[{"start":{"row":74,"column":32},"end":{"row":74,"column":33},"action":"remove","lines":["o"],"id":29},{"start":{"row":74,"column":31},"end":{"row":74,"column":32},"action":"remove","lines":["o"]}],[{"start":{"row":74,"column":31},"end":{"row":74,"column":32},"action":"insert","lines":["0"],"id":30},{"start":{"row":74,"column":32},"end":{"row":74,"column":33},"action":"insert","lines":["0"]},{"start":{"row":74,"column":33},"end":{"row":74,"column":34},"action":"insert","lines":[";"]}],[{"start":{"row":72,"column":12},"end":{"row":74,"column":34},"action":"remove","lines":["triple.rgbtBlue = 0*00;","            triple.rgbtGreen = 0*ff;","            triple.rgbtRed = 0*00;"],"id":31}],[{"start":{"row":72,"column":0},"end":{"row":72,"column":12},"action":"remove","lines":["            "],"id":32}],[{"start":{"row":65,"column":53},"end":{"row":65,"column":61},"action":"remove","lines":["biHeight"],"id":33},{"start":{"row":65,"column":53},"end":{"row":65,"column":54},"action":"insert","lines":["n"]},{"start":{"row":65,"column":54},"end":{"row":65,"column":55},"action":"insert","lines":["e"]},{"start":{"row":65,"column":55},"end":{"row":65,"column":56},"action":"insert","lines":["w"]}],[{"start":{"row":65,"column":55},"end":{"row":65,"column":56},"action":"remove","lines":["w"],"id":34},{"start":{"row":65,"column":54},"end":{"row":65,"column":55},"action":"remove","lines":["e"]},{"start":{"row":65,"column":53},"end":{"row":65,"column":54},"action":"remove","lines":["n"]}],[{"start":{"row":65,"column":53},"end":{"row":65,"column":54},"action":"insert","lines":["b"],"id":35},{"start":{"row":65,"column":54},"end":{"row":65,"column":55},"action":"insert","lines":["i"]},{"start":{"row":65,"column":55},"end":{"row":65,"column":56},"action":"insert","lines":["H"]},{"start":{"row":65,"column":56},"end":{"row":65,"column":57},"action":"insert","lines":["e"]},{"start":{"row":65,"column":57},"end":{"row":65,"column":58},"action":"insert","lines":["i"]}],[{"start":{"row":65,"column":58},"end":{"row":65,"column":59},"action":"insert","lines":["g"],"id":36},{"start":{"row":65,"column":59},"end":{"row":65,"column":60},"action":"insert","lines":["h"]},{"start":{"row":65,"column":60},"end":{"row":65,"column":61},"action":"insert","lines":["t"]}],[{"start":{"row":50,"column":10},"end":{"row":50,"column":11},"action":"insert","lines":[" "],"id":37}],[{"start":{"row":50,"column":10},"end":{"row":50,"column":11},"action":"remove","lines":[" "],"id":38}]]},"ace":{"folds":[],"scrolltop":579.5,"scrollleft":0,"selection":{"start":{"row":49,"column":23},"end":{"row":49,"column":23},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":11,"state":"start","mode":"ace/mode/c_cpp"}},"timestamp":1548442063704}